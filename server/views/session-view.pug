doctype html
html(lang='en')
    head
        meta(charset='UTF-8')
        link(rel='stylesheet' href='/style.css')
        link(rel='icon' type='image/x-icon' href='/images/favicon.ico')
        title PeAR - report

    body
        include header

        #report.centered
            section#session-infos
                h2.v-centered Session Report
                    if session.validated
                        #validated.status VALIDATED
                    else
                        #failed.status FAILED
                ul
                    li game: #[i #{session.game}]
                    li build: #[i #{session.build}]
                    li scene: #[i #{session.scene}]
                    li platform: #[i #{session.platform}]
                    li Unity version: #[i #{session.unityVersion}]
                    li device: #[i #{session.device}]
                        ul
                            li processor: #[i #{session.processorType}]
                            li system memory size: #[i #{session.systemMemory}]
                            li GPU: #[i #{session.GPU}]
                            li GPU memory size: #[i #{session.GPUMemory}]
                    li start date: #[i #{session.startDate}]
                    li duration: #[i #{session.duration} ms]

            section#metrics
                h2 Metrics
                each metricsManager in session.metricsManagers
                    .metric-manager
                        -
                            var formatedName = metricsManager.name.substring(0, 1).toUpperCase() +
                                    metricsManager.name.substring(1)
                                    .replace(/([A-Z])/g, ' $1').toLowerCase();
                        h3.v-centered #{formatedName}
                            if metricsManager.validated
                                #validated.status VALIDATED
                            else
                                #failed.status FAILED

                        each statistic in metricsManager.statistics
                            if statistic.threshold
                                -
                                    formatedName =
                                            metricsManager.name.replace(/([A-Z])/g, '-$1').toLowerCase()
                                            .concat(statistic.name.replace(/([A-Z])/g, '-$1').toLowerCase())
                                            .concat('-chart-container');
                                div(id=formatedName).chart-container

                        ul
                            each statistic in metricsManager.statistics
                                -
                                    var statisticDetails =
                                            statistic.name +
                                            (statistic.threshold ?
                                                    '(' + statistic.threshold.value + ')' : '')
                                            + ': ' + statistic.value;

                                li.v-centered #{statisticDetails}
                                    if statistic.validated != undefined
                                        if statistic.validated
                                            #validated.status VALIDATED
                                        else
                                            #failed.status FAILED

            section#json
                h2 JSON result
                pre
                    code #{JSON.stringify(session, null, 4)}

        include footer

        script(src='https://canvasjs.com/assets/script/canvasjs.min.js')
        include load-chart.pug
